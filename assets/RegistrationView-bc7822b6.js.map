{"version":3,"file":"RegistrationView-bc7822b6.js","sources":["../../node_modules/timezones-list/dist/index.js","../../node_modules/@hcaptcha/vue3-hcaptcha/dist/hcaptcha-vue3.es.js","../../src/components/auth/RegistrationForm.vue","../../src/views/RegistrationView.vue"],"sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst timezones_json_1 = __importDefault(require(\"./timezones.json\"));\r\nexports.default = timezones_json_1.default;\r\n","import { openBlock, createElementBlock } from \"vue\";\nconst SCRIPT_ID = \"hcaptcha-api-script-id\";\nconst HCAPTCHA_LOAD_FN_NAME = \"_hcaptchaOnLoad\";\nlet resolveFn;\nlet rejectFn;\nconst promise = new Promise((resolve, reject) => {\n  resolveFn = resolve;\n  rejectFn = reject;\n});\nfunction loadApiEndpointIfNotAlready(config) {\n  if (window.hcaptcha) {\n    resolveFn();\n    return promise;\n  }\n  if (document.getElementById(SCRIPT_ID)) {\n    return promise;\n  }\n  window[HCAPTCHA_LOAD_FN_NAME] = resolveFn;\n  const scriptSrc = getScriptSrc(config);\n  const script = document.createElement(\"script\");\n  script.id = SCRIPT_ID;\n  script.src = scriptSrc;\n  script.async = true;\n  script.defer = true;\n  script.onerror = (event) => {\n    console.error(\"Failed to load api: \" + scriptSrc, event);\n    rejectFn(\"Failed to load api.js\");\n  };\n  document.head.appendChild(script);\n  return promise;\n}\nfunction getScriptSrc(config) {\n  let scriptSrc = config.apiEndpoint;\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"render\", \"explicit\");\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"onload\", HCAPTCHA_LOAD_FN_NAME);\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"recaptchacompat\", config.reCaptchaCompat === false ? \"off\" : null);\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"hl\", config.language);\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"sentry\", config.sentry);\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"endpoint\", config.endpoint);\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"assethost\", config.assethost);\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"imghost\", config.imghost);\n  scriptSrc = addQueryParamIfDefined(scriptSrc, \"reportapi\", config.reportapi);\n  return scriptSrc;\n}\nfunction addQueryParamIfDefined(url, queryName, queryValue) {\n  if (queryValue !== void 0 && queryValue !== null) {\n    const link = url.includes(\"?\") ? \"&\" : \"?\";\n    return url + link + queryName + \"=\" + encodeURIComponent(queryValue);\n  }\n  return url;\n}\nvar _export_sfc = (sfc, props) => {\n  for (const [key, val] of props) {\n    sfc[key] = val;\n  }\n  return sfc;\n};\nconst _sfc_main = {\n  name: \"VueHcaptcha\",\n  props: {\n    sitekey: {\n      type: String,\n      required: true\n    },\n    theme: {\n      type: String,\n      default: void 0\n    },\n    size: {\n      type: String,\n      default: void 0\n    },\n    tabindex: {\n      type: String,\n      default: void 0\n    },\n    language: {\n      type: String,\n      default: void 0\n    },\n    reCaptchaCompat: {\n      type: Boolean,\n      default: true\n    },\n    challengeContainer: {\n      type: String,\n      default: void 0\n    },\n    rqdata: {\n      type: String,\n      default: void 0\n    },\n    sentry: {\n      type: Boolean,\n      default: true\n    },\n    apiEndpoint: {\n      type: String,\n      default: \"https://hcaptcha.com/1/api.js\"\n    },\n    endpoint: {\n      type: String,\n      default: void 0\n    },\n    reportapi: {\n      type: String,\n      default: void 0\n    },\n    assethost: {\n      type: String,\n      default: void 0\n    },\n    imghost: {\n      type: String,\n      default: void 0\n    }\n  },\n  data: () => {\n    return {\n      widgetId: null,\n      hcaptcha: null,\n      renderedCb: null\n    };\n  },\n  mounted() {\n    return loadApiEndpointIfNotAlready(this.$props).then(this.onApiLoaded).catch(this.onError);\n  },\n  unmounted() {\n    this.teardown();\n  },\n  destroyed() {\n    this.teardown();\n  },\n  methods: {\n    teardown() {\n      if (this.widgetId) {\n        this.hcaptcha.reset(this.widgetId);\n        this.hcaptcha.remove(this.widgetId);\n      }\n    },\n    onApiLoaded() {\n      this.hcaptcha = window.hcaptcha;\n      const opt = {\n        sitekey: this.sitekey,\n        theme: this.theme,\n        size: this.size,\n        tabindex: this.tabindex,\n        \"callback\": this.onVerify,\n        \"expired-callback\": this.onExpired,\n        \"chalexpired-callback\": this.onChallengeExpired,\n        \"error-callback\": this.onError,\n        \"open-callback\": this.onOpen,\n        \"close-callback\": this.onClose\n      };\n      if (this.challengeContainer) {\n        opt[\"challenge-container\"] = this.challengeContainer;\n      }\n      this.widgetId = this.hcaptcha.render(this.$el, opt);\n      if (this.rqdata) {\n        this.hcaptcha.setData(this.widgetId, { rqdata: this.rqdata });\n      }\n      this.onRendered();\n    },\n    execute() {\n      if (this.widgetId) {\n        this.hcaptcha.execute(this.widgetId);\n        this.onExecuted();\n      } else {\n        this.renderedCb = () => {\n          this.renderedCb = null;\n          this.execute();\n        };\n      }\n    },\n    reset() {\n      if (this.widgetId) {\n        this.hcaptcha.reset(this.widgetId);\n        this.onReset();\n      } else {\n        this.$emit(\"error\", \"Element is not rendered yet and thus cannot reset it. Wait for `rendered` event to safely call reset.\");\n      }\n    },\n    onRendered() {\n      this.$emit(\"rendered\");\n      this.renderedCb && this.renderedCb();\n    },\n    onExecuted() {\n      this.$emit(\"executed\");\n    },\n    onReset() {\n      this.$emit(\"reset\");\n    },\n    onError(e) {\n      this.$emit(\"error\", e);\n      this.reset();\n    },\n    onVerify() {\n      const token = this.hcaptcha.getResponse(this.widgetId);\n      const eKey = this.hcaptcha.getRespKey(this.widgetId);\n      this.$emit(\"verify\", token, eKey);\n    },\n    onExpired() {\n      this.$emit(\"expired\");\n    },\n    onChallengeExpired() {\n      this.$emit(\"challengeExpired\");\n    },\n    onOpen() {\n      this.$emit(\"opened\");\n    },\n    onClose() {\n      this.$emit(\"closed\");\n    }\n  }\n};\nconst _hoisted_1 = { id: \"hcap-script\" };\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", _hoisted_1);\n}\nvar hcaptcha = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\nexport { hcaptcha as default };\n","<script setup lang=\"ts\">\nimport timezones from \"timezones-list\";\nimport VueHcaptcha from \"@hcaptcha/vue3-hcaptcha\";\nimport InputLabel from \"../elements/InputLabel.vue\";\nconst hCaptchaKey = import.meta.env.VITE_HCAPTCHA_SITE_KEY;\n</script>\n\n<template>\n  <form @submit.prevent=\"register\" v-if=\"showForm\">\n    <div class=\"form-control\">\n      <InputLabel label=\"Email\" />\n      <input\n        type=\"email\"\n        v-model=\"email\"\n        placeholder=\"email\"\n        class=\"input input-bordered\"\n      />\n    </div>\n    <div class=\"form-control\">\n      <InputLabel label=\"Password\" />\n      <input\n        type=\"password\"\n        v-model=\"password\"\n        placeholder=\"password\"\n        class=\"input input-bordered\"\n      />\n    </div>\n    <div class=\"form-control\">\n      <InputLabel label=\"Timezone\" />\n      <select class=\"select select-bordered w-full\" v-model=\"selectedTz\">\n        <option v-for=\"(option, index) in timezones\" v-bind:key=\"index\">\n          {{ option.label }}\n        </option>\n      </select>\n    </div>\n    <div v-show=\"errorMsg\" class=\"badge badge-error badge-outline w-full\">\n      {{ errorMsg }}\n    </div>\n    <div class=\"form-control mt-3\">\n      <vue-hcaptcha\n        class=\"flex justify-center mb-2\"\n        :sitekey=\"hCaptchaKey\"\n        @verify=\"onCaptchaVerified\"\n        @expired=\"onCaptchaExpired\"\n      ></vue-hcaptcha>\n      <button\n        class=\"btn btn-primary\"\n        :disabled=\"\n          password.length < 6 || email.length < 4 || hCaptchaToken === ''\n        \"\n        type=\"submit\"\n      >\n        Sign up\n      </button>\n    </div>\n  </form>\n  <span v-else>\n    <p>You have successfully registered!</p>\n    <p>Please click on the confirmation link sent to your email address.</p>\n  </span>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { AuthService } from \"./AuthService\";\nimport { ErrorDecoder } from \"@/services/ErrorDecoder\";\n\nexport default defineComponent({\n  data() {\n    return {\n      email: \"\",\n      password: \"\",\n      errorMsg: \"\",\n      selectedTz: \"\",\n      hCaptchaToken: \"\",\n      showForm: true,\n    };\n  },\n  methods: {\n    async register() {\n      const tz = timezones.find((t) => t.label === this.selectedTz);\n      const tzCode = tz ? tz.tzCode : \"Europe/London\";\n      try {\n        await AuthService.userRegister({\n          email: this.email,\n          password: this.password,\n          timezone: tzCode,\n          hcaptcha: this.hCaptchaToken,\n        });\n\n        this.showForm = false;\n        setTimeout(() => {\n          this.$router.push(\"/\");\n        }, 7000);\n      } catch (error) {\n        this.errorMsg = await ErrorDecoder.decode(error);\n      }\n    },\n    onCaptchaVerified(token: string) {\n      this.hCaptchaToken = token;\n    },\n    onCaptchaExpired() {\n      this.hCaptchaToken = \"\";\n    },\n  },\n  beforeMount() {\n    const userTz = Intl.DateTimeFormat().resolvedOptions().timeZone;\n    const tz = timezones.find((t) => t.tzCode === userTz);\n    this.selectedTz = tz ? tz.label : \"Europe/London (GMT+00:00)\";\n  },\n});\n</script>\n","<script setup lang=\"ts\">\nimport RegistrationFormVue from \"../components/auth/RegistrationForm.vue\";\nimport StandardContainer from \"@/components/layout/StandardContainer.vue\";\nimport HeroCard from \"@/components/layout/HeroCard.vue\";\n</script>\n\n<template>\n  <StandardContainer>\n    <HeroCard>\n      <h1 class=\"text-3xl font-bold\">Register</h1>\n      <RegistrationFormVue />\n    </HeroCard>\n  </StandardContainer>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  created() {\n    document.title = \"Registration | Validity.Red\";\n  },\n});\n</script>\n"],"names":["__importDefault","this","mod","dist","timezones_json_1","require$$0","_default","SCRIPT_ID","HCAPTCHA_LOAD_FN_NAME","resolveFn","rejectFn","promise","resolve","reject","loadApiEndpointIfNotAlready","config","scriptSrc","getScriptSrc","script","event","addQueryParamIfDefined","url","queryName","queryValue","link","_export_sfc","sfc","props","key","val","_sfc_main","opt","e","token","eKey","_hoisted_1","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","openBlock","createElementBlock","hcaptcha","__default__","defineComponent","tz","timezones","t","tzCode","AuthService","error","ErrorDecoder","userTz","hCaptchaKey"],"mappings":"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"}