import{d as a,o as s,c as r,a as e,t as c,h as _,j as M,u as l,k as u,b as i,i as p,R as b,w as m,f as w,E as f,I as h,F as k,r as C,g as N,v,D as I,J as x,S as A}from"./index-72efd622.js";import{_ as D}from"./ModalConfirmation.vue_vue_type_script_setup_true_lang-673dce25.js";import{D as $,a as T}from"./DocumentType-53891787.js";import{D as y}from"./DocumentService-c59b69cc.js";import{N as g}from"./NotificationService-e1d4adf3.js";import{N as E}from"./NotificationsOutline-3760a397.js";const B={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},L=e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"square","stroke-miterlimit":"10","stroke-width":"44",d:"M416 128L192 384l-96-96"},null,-1),S=[L],O=a({name:"CheckmarkSharp",render:function(t,n){return s(),r("svg",B,S)}}),V={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},F=e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),j=e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1),R=[F,j],Z=a({name:"CloseOutline",render:function(t,n){return s(),r("svg",V,R)}}),q={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},W=e("path",{d:"M400 145.49L366.51 112L256 222.51L145.49 112L112 145.49L222.51 256L112 366.51L145.49 400L256 289.49L366.51 400L400 366.51L289.49 256L400 145.49z",fill:"currentColor"},null,-1),z=[W],U=a({name:"CloseSharp",render:function(t,n){return s(),r("svg",q,z)}}),G={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},H=e("path",{d:"M416 221.25V416a48 48 0 0 1-48 48H144a48 48 0 0 1-48-48V96a48 48 0 0 1 48-48h98.75a32 32 0 0 1 22.62 9.37l141.26 141.26a32 32 0 0 1 9.37 22.62z",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),J=e("path",{d:"M256 56v120a32 32 0 0 0 32 32h120",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),K=e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M176 288h160"},null,-1),P=e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M176 368h160"},null,-1),Q=[H,J,K,P],X=a({name:"DocumentTextOutline",render:function(t,n){return s(),r("svg",G,Q)}}),Y={class:"card shadow-lg bg-base-100"},tt={class:"card-body"},et={class:"my-4 text-3xl font-bold card-title"},ot={class:"mb-4 space-x-2 card-actions"},nt={class:"badge badge-lg badge-ghost"},st=["value"],it={class:"justify-end space-x-2 card-actions"},rt=["href"],at=a({data(){return{deleteAnchor:"#delete-document",deleteModalId:"delete-document",errorMsg:""}},methods:{async deleteDocument(){this.errorMsg="";try{await y.deleteOne(this.document.ID),this.$router.push("/documents")}catch(o){this.errorMsg=await f.decode(o)}}}}),dt=a({...at,__name:"DocumentCard",props:{document:null},setup(o){return(t,n)=>(s(),r("div",Y,[e("div",tt,[e("h2",et,c(o.document.title),1),e("div",ot,[e("div",nt,[(s(),_(M(l($).getIcon(o.document.type)),{class:"w-4 mr-1"})),u(" "+c(l($).getName(o.document.type)),1)])]),e("textarea",{class:"textarea h-full min-h-[20vh]",value:o.document.description,readonly:""},null,8,st),e("div",it,[i(l(b),{to:`/documents/${o.document.ID}/edit`,class:"btn btn-primary","v-model":o.document.ID},{default:p(()=>[u("Edit")]),_:1},8,["to","v-model"]),e("a",{href:t.deleteAnchor,class:"btn"},"Delete",8,rt)]),m(e("div",{class:"badge badge-error badge-outline w-full"},c(t.errorMsg),513),[[w,t.errorMsg]])]),i(D,{modalId:t.deleteModalId,message:"Are you sure that you want to delete this document:",actionName:o.document.title||"",onConfirmEvent:t.deleteDocument},null,8,["modalId","actionName","onConfirmEvent"])]))}}),lt={class:"indicator w-full"},ct={class:"indicator-item indicator-middle indicator-end"},ut=["href"],mt={class:"grid w-full h-10 rounded bg-primary text-primary-content place-content-center my-1"},ht={key:0},ft={key:1},_t=a({data(){return{dateWithTZ:new Date(this.notification.date).toLocaleString("en-GB",{timeZoneName:"short"}),deleteAnchor:"",deleteModalId:"",errorMsg:""}},methods:{setContext(){this.deleteAnchor=`#delete-${this.notification.ID}`,this.deleteModalId=`delete-${this.notification.ID}`},async deleteNotification(){this.errorMsg="";try{await g.deleteOne({id:this.notification.ID,documentId:this.notification.documentID}),this.$emit("refreshNotificationsEvent")}catch(o){this.errorMsg=await f.decode(o)}}},beforeMount(){this.setContext()}}),pt=a({..._t,__name:"NotificationItem",props:{notification:null},setup(o){return(t,n)=>(s(),r("div",lt,[e("div",ct,[e("a",{href:t.deleteAnchor,class:"btn btn-xs btn-accent btn-circle"},[i(l(Z),{class:"w-5"})],8,ut)]),e("div",mt,[t.errorMsg?h("",!0):(s(),r("p",ht,c(t.dateWithTZ),1)),t.errorMsg?(s(),r("p",ft,"Error: "+c(t.errorMsg),1)):h("",!0)]),i(D,{modalId:t.deleteModalId,message:"Are you sure that you want to delete this notification:",actionName:t.dateWithTZ,onConfirmEvent:t.deleteNotification},null,8,["modalId","actionName","onConfirmEvent"])]))}}),wt={class:"card shadow-lg bg-base-100"},gt={class:"card-body"},vt={class:"my-4 text-xl font-bold card-title"},$t={key:0,class:"text-center my-5"},bt={class:"form-control"},kt={class:"input-group"},Dt=["min"],yt={class:"btn btn-square btn-primary",type:"submit"},Mt={key:2,class:"justify-center space-x-2 card-actions"},Ct=a({data(){return{isFormActive:!1,isAddButtonActive:!0,minDate:new Date().toISOString().split("T")[0],inputDate:"",inputTime:"",errorMsg:""}},methods:{refreshNotificationsEmit(){this.$emit("refreshNotificationsEvent")},async submit(){this.errorMsg="";const o=new Date(`${this.inputDate}T${this.inputTime}:00`);if(isNaN(o.getTime())){this.errorMsg="Invalid date.";return}if(new Date(o)<new Date)return this.errorMsg="Notification date is in the past!",!1;try{await g.createOne({date:new Date(o),documentId:this.documentId})}catch(t){this.errorMsg=await f.decode(t)}this.closeFromClicked(),this.$emit("refreshNotificationsEvent")},addButtonClicked(){this.isFormActive=!0,this.isAddButtonActive=!1},closeFromClicked(){this.isFormActive=!1,this.isAddButtonActive=!0}}}),Nt=a({...Ct,__name:"NotificationsCard",props:{notifications:null,documentId:null},setup(o){return(t,n)=>(s(),r("div",wt,[e("div",gt,[e("h2",vt,[i(l(E),{class:"w-5 inline"}),u(" Notifications ")]),o.notifications.length===0?(s(),r("p",$t," Add notifications.. ")):h("",!0),(s(!0),r(k,null,C(o.notifications,d=>(s(),_(pt,{key:d.ID,notification:d,onRefreshNotificationsEvent:t.refreshNotificationsEmit},null,8,["notification","onRefreshNotificationsEvent"]))),128)),t.isFormActive?(s(),r("form",{key:1,onSubmit:n[3]||(n[3]=N((...d)=>t.submit&&t.submit(...d),["prevent"])),class:"mt-2"},[e("div",bt,[e("div",kt,[m(e("input",{type:"date",min:t.minDate,class:"input input-bordered w-[100vw]","onUpdate:modelValue":n[0]||(n[0]=d=>t.inputDate=d)},null,8,Dt),[[v,t.inputDate]]),m(e("input",{type:"time",class:"input input-bordered w-[50vw]","onUpdate:modelValue":n[1]||(n[1]=d=>t.inputTime=d)},null,512),[[v,t.inputTime]]),e("button",yt,[i(l(O),{class:"w-5"})]),e("button",{class:"btn btn-square",onClick:n[2]||(n[2]=(...d)=>t.closeFromClicked&&t.closeFromClicked(...d))},[i(l(U),{class:"w-5"})])])])],32)):h("",!0),t.isAddButtonActive?(s(),r("div",Mt,[e("button",{class:"btn btn-primary btn-circle",onClick:n[4]||(n[4]=(...d)=>t.addButtonClicked&&t.addButtonClicked(...d))},[i(l(I),{class:"w-5"})])])):h("",!0),m(e("div",{class:"badge badge-error badge-outline w-full"},c(t.errorMsg),513),[[w,t.errorMsg]])])]))}}),It={class:"text-sm breadcrumbs"},xt=a({__name:"DocumentBreadcrumbs",props:{title:null},setup(o){return(t,n)=>(s(),r("div",It,[e("ul",null,[e("li",null,[i(l(b),{to:"/documents"},{default:p(()=>[i(l(T),{class:"w-4 mr-1"}),u(" Documents ")]),_:1})]),e("li",null,[i(l(X),{class:"w-4 mr-1"}),u(" "+c(o.title),1)])])]))}}),At={class:"card shadow-lg bg-base-100"},Tt={class:"card-body"},Et={class:"grid grid-cols-2 gap-0"},Bt={class:"text-xl font-bold"},Lt={class:"text-xl text-right"},St=a({__name:"ExpirationCard",props:{expiresAt:null},setup(o){return(t,n)=>(s(),r("div",At,[e("div",Tt,[e("div",Et,[e("h3",Bt,[i(l(x),{class:"w-5 inline"}),u(" Valid until: ")]),e("p",Lt,c(o.expiresAt),1)])])]))}}),Ot={class:"grid grid-cols-1 gap-6 py-5 lg:px-10 xl:grid-cols-3 lg:bg-base-200 rounded-box"},Vt=a({data(){return{document:{},notifications:[],documentId:typeof this.$route.params.id=="string"?this.$route.params.id:"",errorMsg:""}},emits:["setDocumentTitle"],methods:{async fetchDocument(){try{this.errorMsg="",this.document=await y.getOne(this.documentId),this.$emit("setDocumentTitle",this.document.title)}catch(o){this.errorMsg=await f.decode(o,this.$router)}},async fetchNotifications(){try{this.notifications=await g.getAll(this.documentId)}catch(o){this.errorMsg=await f.decode(o)}}},async beforeMount(){await this.fetchDocument(),await this.fetchNotifications()}}),Ft=a({...Vt,__name:"DocumentFullBlock",setup(o){return(t,n)=>(s(),r(k,null,[i(xt,{title:t.document.title||"",class:"lg:px-10 pt-7"},null,8,["title"]),m(e("div",{class:"badge badge-error badge-outline w-full"}," Error: "+c(t.errorMsg),513),[[w,t.errorMsg]]),e("div",Ot,[i(dt,{document:t.document,class:"card col-span-1 row-span-3 xl:col-span-2"},null,8,["document"]),i(St,{expiresAt:t.document.expiresAt||"",class:"card col-span-1 row-span-1"},null,8,["expiresAt"]),i(Nt,{class:"card col-span-1 row-span-2",notifications:t.notifications,documentId:t.documentId,onRefreshNotificationsEvent:t.fetchNotifications},null,8,["notifications","documentId","onRefreshNotificationsEvent"])])],64))}}),jt=a({methods:{setDocumentTitle(o){document.title=o+" | Validity.Red"}},created(){document.title="Document | Validity.Red"}}),Gt=a({...jt,__name:"DocumentView",setup(o){return(t,n)=>(s(),_(A,null,{default:p(()=>[i(Ft,{onSetDocumentTitle:t.setDocumentTitle},null,8,["onSetDocumentTitle"])]),_:1}))}});export{Gt as default};
//# sourceMappingURL=DocumentView-6ea64d69.js.map
