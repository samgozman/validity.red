import{D as l}from"./DocumentService-9ed7368b.js";import{N as g}from"./NotificationService-0a996667.js";import{D as u}from"./DocumentType-69b8dd92.js";import{d as p,E as h,B as b,o as r,c as n,a as e,w as o,v as c,t as d,e as y,F as _,r as D,G as w,I as v,f as x,g as M,k as m,h as E,i as I,S,b as N}from"./index-ca8ec35b.js";const A=p({data(){return{title:"",description:"",type:"Select document type",minDate:new Date().toISOString().split("T")[0],expiresAt:"",createDefaultNotification:!0,typeOptions:u.types,documentTypeId:0,isEditMode:!1,documentId:"",errorMsg:""}},methods:{isEmpty(t,s){return t===""?(this.errorMsg=s,!0):!1},isLonger(t,s,a){return t.length>s?(this.errorMsg=a,!0):!1},isValidDate(t){const s=Date.parse(t);return isNaN(s)?(this.errorMsg="Invalid date. Please use the format YYYY-MM-DD",!0):!1},isExpired(t){if(t<new Date)return this.errorMsg="Expiration date is in the past!",!1},async createDocument(t){this.documentId=await l.createOne({title:this.title,description:this.description,type:this.documentTypeId,expiresAt:t})},async updateDocument(t){await l.updateOne({id:this.documentId,title:this.title,description:this.description,type:this.documentTypeId,expiresAt:t})},async submit(){try{if(this.errorMsg="",this.isEmpty(this.title,"Title is required!")||this.isLonger(this.title,100,"Title is too long!")||this.isLonger(this.description,500,"Description is too long!")||this.isEmpty(this.expiresAt,"Expiration date is required!")||this.isValidDate(this.expiresAt))return;const t=new Date(Date.parse(this.expiresAt)),s=[...this.typeOptions.values()].map(a=>a.name).indexOf(this.type);if(this.documentTypeId=s===-1?0:s,this.isEditMode)await this.updateDocument(t);else{if(this.isExpired(t))return;await this.createDocument(t),this.createDefaultNotification&&(t.setHours(10),await g.createOne({date:t,documentId:this.documentId}))}this.$router.push({name:"document",params:{id:this.documentId}})}catch(t){this.errorMsg=await h.decode(t)}}},async beforeMount(){if(this.$route.params.id&&(this.createDefaultNotification=!1,this.isEditMode=!0,this.documentId=typeof this.$route.params.id=="string"?this.$route.params.id:""),this.isEditMode)try{const t=await l.getOne(this.documentId);this.title=t.title||"",this.description=t.description||"",this.type=u.getName(t.type),this.expiresAt=new Date(t.expiresAt).toISOString().split("T")[0]}catch(t){this.errorMsg=await h.decode(t,this.$router)}}}),V={class:"grid grid-cols-1 gap-6 py-5 lg:px-10 lg:grid-cols-3 lg:bg-base-200 rounded-box"},T={class:"card-card-compact card xl:card-normal col-span-1 row-span-1 shadow-lg lg:col-span-2 bg-base-100"},O={class:"card-body form-control"},$=e("h2",{class:"card-title"},"Title",-1),k={class:"label"},C=e("span",{class:"label-text text-base-300"}," Avoid unnecessary details. ",-1),B={class:"label-text-alt text-base-300"},U={class:"card-card-compact card xl:card-normal col-span-1 row-span-2 shadow-lg lg:col-span-1 bg-base-100"},L={class:"card-body"},Y=e("h2",{class:"card-title"},"Document settings",-1),q=e("option",{disabled:"",selected:""},"Select document type",-1),F=e("div",{class:"divider"},"Expires at",-1),P={class:"input-group"},G=["min"],H=e("span",null,"Expiration",-1),R={class:"card-card-compact card xl:card-normal col-span-1 row-span-2 shadow-lg lg:col-span-2 bg-base-100"},W={class:"card-body form-control"},j=e("h2",{class:"card-title"},"Description",-1),z={class:"label"},J=e("span",{class:"label-text text-base-300"},[m(" Avoid unnecessary details. We don't need exact information about your document. "),e("br"),m(" Please use this field only to distinguish documents from each other. ")],-1),K={class:"label-text-alt text-base-300"},Q={class:"card-card-compact card xl:card-normal col-span-1 row-span-1 shadow-lg lg:col-span-1 bg-base-100"},X={class:"card-body"},Z={key:0,class:"form-control"},tt={class:"label cursor-pointer"},et=e("span",{class:"label-text"},"Add default notification?",-1),st=e("button",{class:"btn btn-primary",type:"submit"},"Save",-1);function it(t,s,a,rt,nt,dt){return r(),n("form",{onSubmit:s[5]||(s[5]=M((...i)=>t.submit&&t.submit(...i),["prevent"]))},[e("div",V,[e("div",T,[e("div",O,[$,o(e("input",{type:"text",placeholder:"Document title",minlength:"3",maxlength:"100",class:"input w-full","onUpdate:modelValue":s[0]||(s[0]=i=>t.title=i)},null,512),[[c,t.title]]),e("label",k,[C,e("span",B,d(t.title.length)+"/100 ",1)])])]),e("div",U,[e("div",L,[Y,o(e("select",{class:"select select-bordered w-full","onUpdate:modelValue":s[1]||(s[1]=i=>t.type=i)},[q,(r(!0),n(_,null,D(t.typeOptions.values(),(i,f)=>(r(),n("option",{key:f},d(i.name),1))),128))],512),[[y,t.type]]),F,e("label",P,[o(e("input",{type:"date",min:t.minDate,class:"input input-bordered w-[100vw]","onUpdate:modelValue":s[2]||(s[2]=i=>t.expiresAt=i)},null,8,G),[[c,t.expiresAt]]),H])])]),e("div",R,[e("div",W,[j,o(e("textarea",{class:"textarea h-full min-h-[20vh]",placeholder:"Description (optional)",maxlength:"500","onUpdate:modelValue":s[3]||(s[3]=i=>t.description=i)},null,512),[[c,t.description]]),e("label",z,[J,e("span",K,d(t.description.length)+"/500 ",1)])])]),e("div",Q,[e("div",X,[t.isEditMode?v("",!0):(r(),n("div",Z,[e("label",tt,[et,o(e("input",{type:"checkbox",class:"toggle toggle-primary","onUpdate:modelValue":s[4]||(s[4]=i=>t.createDefaultNotification=i),"checked:":"true"},null,512),[[w,t.createDefaultNotification]])])])),st,o(e("div",{class:"badge badge-error badge-outline w-full"},d(t.errorMsg),513),[[x,t.errorMsg]])])])])],32)}const ot=b(A,[["render",it]]),at=p({created(){document.title="Create document | Validity.Red"}}),ht=p({...at,__name:"DocumentCreateView",setup(t){return(s,a)=>(r(),E(S,null,{default:I(()=>[N(ot)]),_:1}))}});export{ht as default};
//# sourceMappingURL=DocumentCreateView-2cdbbce6.js.map
